# Output + calculation of openssl encryption as a means of simulating cpu time
# delay. The experiment was run on a 2.8 GHZ machine with 16 GB RAM. The C code
# is attached as a comment below:
#
# #include <openssl/aes.h>
#  const unsigned char key[] = {
#    0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
#    0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
#    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
#    0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f
#  };
#
#  unsigned char text[] = "ransdfs;ldldfhsda;fhsda;lkfsd;lfkhadsf;lhgiug34giu3qhfiqu3qhf3u4g34puh34oupuhg34pouggh324poutth324weopfhwewopvvhm98fgroucgmoiugceoiucgerioucgreioug merwioucgmreicouogh,weiucgb3u,9guh3ccoigucbg,coiehg4oiucgh24ucgh23ciuh3m4cmg0-93ux,powhtqweeo;flxfh,3oiheoifhaerouhe[oifh3w4q8g92rh2'I[GHTQ3[[8RFH24P9UGHQE[0B842THWEPOGTHQ34PGUH34GP98T34HGPOIW;LHALGQ3PU4GHQ489WGHQWEPOIGH34PT9834HTPIQWHFO4oiggh324oih324oipghq;lo;ifo3rohg342oi2gh33;lrgh3;3o2ighigh324;oiggh3oi;fhh32oi4igh34o;igh34oigh234iogh32ugh32ugh342ough34ouugh234uogh324ugh34gou34h2gou2344hgou34hgou32pugb342ough324oiggh34poigh234oigh324opgh342goiherengui3ht93p48y439thg9hg89-3h2g9834hg9384gh34984gh23498gh239uhg34289gh24389-gh32498gh34-98gh239ugh3489gh34g8023h4g9-8432hg9834hg8-342hg3498ghprueher89gh34-8gh324-8gh342g-8342g34g3gdom text23;OIH34POTOUHQ3GUPI34HIUG34HGUPI4W5HGPUERHGPOI45HGIOERGJ4W5POHGIN3P9UGHERPGHW45OGH3ROEIUVSDFFKJGHSADV980745HG9RHGWO4I5THGSIUOBUHWT[T88TH34GP9UEWRHGP9REROBHBEWIUGMC8R7OICIGNUGCEMWROIGM349M4GHEQR,EUG9O3HMG,8G7CORIMGCG,OIMWEUHM,G9PEWRVGW";
#
#  unsigned char enc_out[2][1024];
#  AES_KEY enc_key, dec_key;
#  AES_set_encrypt_key(key, 128, &enc_key);
#  AES_set_decrypt_key(key, 128, &dec_key);
#  AES_encrypt(text, enc_out[0], &enc_key);
#  struct timeval tv;
#
#  for(int i = 1; i <= 1000; i++){
#    gettimeofday(&tv,NULL);
#    unsigned long start = 1000000 * tv.tv_sec + tv.tv_usec;
#
#    for(int j = 0; j < i * 1000; j++){
cdg#      AES_encrypt(enc_out[j % 2], enc_out[(j + 1) % 2], &enc_key);
#    }
#
#    gettimeofday(&tv,NULL);
#    unsigned long end = 1000000 * tv.tv_sec + tv.tv_usec;
#
#    printf("%d, %lu\n", i * 1000, (end - start));
#  }

import numpy

iterations = [1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000, 11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, 20000, 21000, 22000, 23000, 24000, 25000, 26000, 27000, 28000, 29000, 30000, 31000, 32000, 33000, 34000, 35000, 36000, 37000, 38000, 39000, 40000, 41000, 42000, 43000, 44000, 45000, 46000, 47000, 48000, 49000, 50000, 51000, 52000, 53000, 54000, 55000, 56000, 57000, 58000, 59000, 60000, 61000, 62000, 63000, 64000, 65000, 66000, 67000, 68000, 69000, 70000, 71000, 72000, 73000, 74000, 75000, 76000, 77000, 78000, 79000, 80000, 81000, 82000, 83000, 84000, 85000, 86000, 87000, 88000, 89000, 90000, 91000, 92000, 93000, 94000, 95000, 96000, 97000, 98000, 99000, 100000, 101000, 102000, 103000, 104000, 105000, 106000, 107000, 108000, 109000, 110000, 111000, 112000, 113000, 114000, 115000, 116000, 117000, 118000, 119000, 120000, 121000, 122000, 123000, 124000, 125000, 126000, 127000, 128000, 129000, 130000, 131000, 132000, 133000, 134000, 135000, 136000, 137000, 138000, 139000, 140000, 141000, 142000, 143000, 144000, 145000, 146000, 147000, 148000, 149000, 150000, 151000, 152000, 153000, 154000, 155000, 156000, 157000, 158000, 159000, 160000, 161000, 162000, 163000, 164000, 165000, 166000, 167000, 168000, 169000, 170000, 171000, 172000, 173000, 174000, 175000, 176000, 177000, 178000, 179000, 180000, 181000, 182000, 183000, 184000, 185000, 186000, 187000, 188000, 189000, 190000, 191000, 192000, 193000, 194000, 195000, 196000, 197000, 198000, 199000, 200000, 201000, 202000, 203000, 204000, 205000, 206000, 207000, 208000, 209000, 210000, 211000, 212000, 213000, 214000, 215000, 216000, 217000, 218000, 219000, 220000, 221000, 222000, 223000, 224000, 225000, 226000, 227000, 228000, 229000, 230000, 231000, 232000, 233000, 234000, 235000, 236000, 237000, 238000, 239000, 240000, 241000, 242000, 243000, 244000, 245000, 246000, 247000, 248000, 249000, 250000, 251000, 252000, 253000, 254000, 255000, 256000, 257000, 258000, 259000, 260000, 261000, 262000, 263000, 264000, 265000, 266000, 267000, 268000, 269000, 270000, 271000, 272000, 273000, 274000, 275000, 276000, 277000, 278000, 279000, 280000, 281000, 282000, 283000, 284000, 285000, 286000, 287000, 288000, 289000, 290000, 291000, 292000, 293000, 294000, 295000, 296000, 297000, 298000, 299000, 300000, 301000, 302000, 303000, 304000, 305000, 306000, 307000, 308000, 309000, 310000, 311000, 312000, 313000, 314000, 315000, 316000, 317000, 318000, 319000, 320000, 321000, 322000, 323000, 324000, 325000, 326000, 327000, 328000, 329000, 330000, 331000, 332000, 333000, 334000, 335000, 336000, 337000, 338000, 339000, 340000, 341000, 342000, 343000, 344000, 345000, 346000, 347000, 348000, 349000, 350000, 351000, 352000, 353000, 354000, 355000, 356000, 357000, 358000, 359000, 360000, 361000, 362000, 363000, 364000, 365000, 366000, 367000, 368000, 369000, 370000, 371000, 372000, 373000, 374000, 375000, 376000, 377000, 378000, 379000, 380000, 381000, 382000, 383000, 384000, 385000, 386000, 387000, 388000, 389000, 390000, 391000, 392000, 393000, 394000, 395000, 396000, 397000, 398000, 399000, 400000, 401000, 402000, 403000, 404000, 405000, 406000, 407000, 408000, 409000, 410000, 411000, 412000, 413000, 414000, 415000, 416000, 417000, 418000, 419000, 420000, 421000, 422000, 423000, 424000, 425000, 426000, 427000, 428000, 429000, 430000, 431000, 432000, 433000, 434000, 435000, 436000, 437000, 438000, 439000, 440000, 441000, 442000, 443000, 444000, 445000, 446000, 447000, 448000, 449000, 450000, 451000, 452000, 453000, 454000, 455000, 456000, 457000, 458000, 459000, 460000, 461000, 462000, 463000, 464000, 465000, 466000, 467000, 468000, 469000, 470000, 471000, 472000, 473000, 474000, 475000, 476000, 477000, 478000, 479000, 480000, 481000, 482000, 483000, 484000, 485000, 486000, 487000, 488000, 489000, 490000, 491000, 492000, 493000, 494000, 495000, 496000, 497000, 498000, 499000, 500000, 501000, 502000, 503000, 504000, 505000, 506000, 507000, 508000, 509000, 510000, 511000, 512000, 513000, 514000, 515000, 516000, 517000, 518000, 519000, 520000, 521000, 522000, 523000, 524000, 525000, 526000, 527000, 528000, 529000, 530000, 531000, 532000, 533000, 534000, 535000, 536000, 537000, 538000, 539000, 540000, 541000, 542000, 543000, 544000, 545000, 546000, 547000, 548000, 549000, 550000, 551000, 552000, 553000, 554000, 555000, 556000, 557000, 558000, 559000, 560000, 561000, 562000, 563000, 564000, 565000, 566000, 567000, 568000, 569000, 570000, 571000, 572000, 573000, 574000, 575000, 576000, 577000, 578000, 579000, 580000, 581000, 582000, 583000, 584000, 585000, 586000, 587000, 588000, 589000, 590000, 591000, 592000, 593000, 594000, 595000, 596000, 597000, 598000, 599000, 600000, 601000, 602000, 603000, 604000, 605000, 606000, 607000, 608000, 609000, 610000, 611000, 612000, 613000, 614000, 615000, 616000, 617000, 618000, 619000, 620000, 621000, 622000, 623000, 624000, 625000, 626000, 627000, 628000, 629000, 630000, 631000, 632000, 633000, 634000, 635000, 636000, 637000, 638000, 639000, 640000, 641000, 642000, 643000, 644000, 645000, 646000, 647000, 648000, 649000, 650000, 651000, 652000, 653000, 654000, 655000, 656000, 657000, 658000, 659000, 660000, 661000, 662000, 663000, 664000, 665000, 666000, 667000, 668000, 669000, 670000, 671000, 672000, 673000, 674000, 675000, 676000, 677000, 678000, 679000, 680000, 681000, 682000, 683000, 684000, 685000, 686000, 687000, 688000, 689000, 690000, 691000, 692000, 693000, 694000, 695000, 696000, 697000, 698000, 699000, 700000, 701000, 702000, 703000, 704000, 705000, 706000, 707000, 708000, 709000, 710000, 711000, 712000, 713000, 714000, 715000, 716000, 717000, 718000, 719000, 720000, 721000, 722000, 723000, 724000, 725000, 726000, 727000, 728000, 729000, 730000, 731000, 732000, 733000, 734000, 735000, 736000, 737000, 738000, 739000, 740000, 741000, 742000, 743000, 744000, 745000, 746000, 747000, 748000, 749000, 750000, 751000, 752000, 753000, 754000, 755000, 756000, 757000, 758000, 759000, 760000, 761000, 762000, 763000, 764000, 765000, 766000, 767000, 768000, 769000, 770000, 771000, 772000, 773000, 774000, 775000, 776000, 777000, 778000, 779000, 780000, 781000, 782000, 783000, 784000, 785000, 786000, 787000, 788000, 789000, 790000, 791000, 792000, 793000, 794000, 795000, 796000, 797000, 798000, 799000, 800000, 801000, 802000, 803000, 804000, 805000, 806000, 807000, 808000, 809000, 810000, 811000, 812000, 813000, 814000, 815000, 816000, 817000, 818000, 819000, 820000, 821000, 822000, 823000, 824000, 825000, 826000, 827000, 828000, 829000, 830000, 831000, 832000, 833000, 834000, 835000, 836000, 837000, 838000, 839000, 840000, 841000, 842000, 843000, 844000, 845000, 846000, 847000, 848000, 849000, 850000, 851000, 852000, 853000, 854000, 855000, 856000, 857000, 858000, 859000, 860000, 861000, 862000, 863000, 864000, 865000, 866000, 867000, 868000, 869000, 870000, 871000, 872000, 873000, 874000, 875000, 876000, 877000, 878000, 879000, 880000, 881000, 882000, 883000, 884000, 885000, 886000, 887000, 888000, 889000, 890000, 891000, 892000, 893000, 894000, 895000, 896000, 897000, 898000, 899000, 900000, 901000, 902000, 903000, 904000, 905000, 906000, 907000, 908000, 909000, 910000, 911000, 912000, 913000, 914000, 915000, 916000, 917000, 918000, 919000, 920000, 921000, 922000, 923000, 924000, 925000, 926000, 927000, 928000, 929000, 930000, 931000, 932000, 933000, 934000, 935000, 936000, 937000, 938000, 939000, 940000, 941000, 942000, 943000, 944000, 945000, 946000, 947000, 948000, 949000, 950000, 951000, 952000, 953000, 954000, 955000, 956000, 957000, 958000, 959000, 960000, 961000, 962000, 963000, 964000, 965000, 966000, 967000, 968000, 969000, 970000, 971000, 972000, 973000, 974000, 975000, 976000, 977000, 978000, 979000, 980000, 981000, 982000, 983000, 984000, 985000, 986000, 987000, 988000, 989000, 990000, 991000, 992000, 993000, 994000, 995000, 996000, 997000, 998000, 999000, 1000000]

delay = [02, 204, 306, 408, 510, 662, 763, 818, 918, 1020, 1205, 1224, 1326, 1480, 1530, 1671, 1741, 1835, 2240, 2041, 2190, 2245, 2398, 2497, 2600, 2653, 2755, 2943, 2959, 3094, 3163, 3304, 3416, 3570, 3568, 3672, 3846, 3963, 3979, 4144, 4185, 4329, 4388, 4539, 4639, 4918, 4848, 5062, 5090, 5225, 5199, 5353, 6666, 5685, 5685, 5707, 5950, 5916, 6065, 6180, 6223, 6378, 6506, 6529, 6676, 6768, 6918, 6985, 7081, 7143, 8280, 7392, 7532, 7600, 7650, 7790, 7888, 8069, 8197, 8233, 8347, 8438, 8684, 8708, 8767, 8889, 8925, 9936, 9618, 9809, 9540, 9635, 11080, 10546, 10606, 10735, 10849, 11018, 11072, 11285, 11321, 11481, 11491, 11597, 11742, 11851, 12098, 12142, 12190, 12955, 12500, 12674, 12610, 12712, 12904, 12962, 13099, 13201, 13271, 13384, 13498, 13645, 13757, 13901, 13944, 14199, 14516, 14342, 14394, 14504, 14670, 14755, 15394, 15007, 14181, 14153, 14080, 14233, 14295, 14884, 14665, 14586, 14711, 15010, 14861, 16362, 15167, 15177, 15320, 15396, 15539, 15555, 15715, 15805, 15839, 16015, 16058, 16215, 16452, 16471, 16526, 16651, 16718, 16880, 16967, 17015, 17102, 17233, 17320, 17442, 17486, 17751, 17766, 18008, 18099, 19531, 18408, 18221, 18420, 18488, 18580, 18687, 18764, 18878, 18969, 19198, 19370, 19702, 19462, 19481, 19654, 20620, 20438, 20187, 20180, 20167, 20243, 20406, 20384, 20902, 21751, 21042, 20882, 20890, 21109, 21166, 21222, 21422, 21416, 21775, 21748, 22002, 22032, 21927, 22312, 22228, 22242, 22350, 22443, 23074, 22787, 22754, 23171, 24297, 24200, 23824, 23358, 23370, 23508, 23643, 23655, 23879, 24047, 24405, 24110, 24196, 25348, 24952, 25254, 24779, 24861, 24935, 25037, 25186, 26621, 25319, 25406, 25431, 25558, 30271, 53808, 26600, 26175, 30957, 28072, 26990, 27597, 28634, 28434, 26790, 28872, 28600, 29616, 37785, 40084, 48039, 37122, 37750, 39844, 31716, 28700, 30036, 28271, 28789, 29627, 29548, 29281, 29474, 29068, 29161, 29430, 29044, 29271, 50865, 35660, 31132, 32192, 34751, 30763, 31004, 31319, 31977, 30553, 30240, 30251, 30329, 30489, 30657, 30808, 35102, 34950, 33780, 33045, 33535, 33465, 33686, 33554, 33387, 34500, 37045, 33691, 34181, 34020, 34981, 34611, 33635, 34940, 34908, 32973, 33288, 33102, 33086, 33506, 34697, 33646, 33633, 33814, 33898, 34531, 34159, 34389, 35613, 34483, 34550, 34423, 34792, 34594, 34610, 35246, 34888, 34967, 35317, 35370, 35319, 35429, 35487, 35690, 35628, 35870, 36121, 35995, 36351, 36256, 36287, 36453, 36614, 37170, 36677, 36846, 39458, 37374, 38150, 37325, 37534, 37396, 38380, 37607, 37741, 37855, 38086, 38189, 38128, 38265, 38387, 38442, 38608, 38897, 38763, 39102, 38965, 39063, 39180, 39468, 39754, 39477, 41455, 40226, 39823, 40175, 40208, 40109, 40950, 41840, 40800, 40798, 40865, 40665, 40900, 41077, 41551, 51270, 59579, 47972, 50337, 46842, 51369, 49082, 50141, 46184, 47611, 48216, 49014, 48859, 45664, 43165, 43362, 45409, 46757, 50186, 44961, 47179, 50939, 46715, 49379, 47343, 49215, 49206, 48820, 50224, 48652, 51249, 47984, 48420, 47816, 50162, 48399, 48738, 48363, 50467, 49998, 48274, 50257, 53133, 49812, 50848, 51129, 51710, 50401, 51988, 52111, 51513, 57904, 56647, 53646, 51343, 53814, 53830, 49671, 48239, 47451, 48491, 48045, 48573, 48072, 50139, 50833, 49957, 55886, 56272, 53943, 50496, 48895, 48549, 48957, 48734, 50240, 49478, 51557, 53401, 52460, 51776, 51817, 49807, 50288, 50132, 56400, 58097, 58867, 57854, 56673, 57148, 55613, 55135, 58442, 56979, 57607, 57518, 57252, 57235, 56938, 59433, 55467, 56917, 55759, 55551, 57497, 56678, 55689, 59179, 58166, 57545, 58040, 57701, 55851, 56626, 59521, 57743, 58277, 58346, 56714, 61776, 59068, 60858, 57726, 63849, 60574, 63849, 61964, 59834, 59287, 58266, 60327, 72213, 68823, 65320, 67703, 67867, 65168, 66795, 67076, 66018, 63896, 57401, 58538, 64605, 66513, 65308, 59763, 62213, 63738, 59493, 58773, 60784, 58447, 65881, 58646, 61983, 66100, 67812, 66265, 66446, 68091, 59120, 62730, 64491, 58796, 58894, 60063, 61386, 64423, 65707, 66834, 64450, 63168, 64049, 64760, 70070, 69115, 69483, 69192, 70944, 74648, 68847, 63875, 64678, 63611, 65584, 73820, 66955, 64580, 61597, 64437, 71995, 73694, 65574, 62039, 65027, 65569, 68410, 75249, 80354, 69316, 63813, 65785, 64963, 64268, 65757, 62727, 65095, 64224, 64419, 64257, 68178, 63539, 66951, 66515, 65679, 64622, 65311, 64061, 64693, 67819, 66435, 67824, 69355, 65994, 66821, 67123, 66980, 66308, 66717, 65712, 65167, 65341, 66336, 66017, 66246, 65920, 69862, 67350, 67204, 66740, 66396, 66849, 67323, 67791, 66866, 69220, 67805, 68946, 73833, 67436, 68547, 68796, 68335, 69043, 67962, 67529, 68608, 69723, 68387, 68306, 68816, 68904, 68467, 68661, 68503, 68486, 68641, 70028, 69509, 69313, 69912, 70070, 70413, 70064, 69931, 69631, 69641, 69998, 69941, 72929, 74334, 75951, 74512, 74700, 76842, 72515, 72284, 71176, 71134, 71823, 71343, 71862, 71351, 71718, 72217, 71895, 71864, 71757, 72582, 74876, 73821, 75605, 73719, 73051, 72554, 72889, 72706, 72868, 73339, 73020, 73155, 73234, 74064, 75726, 73648, 74731, 73808, 75587, 75308, 74538, 74470, 74282, 74803, 74553, 74629, 75386, 81939, 84408, 86020, 80745, 80939, 88503, 80071, 80875, 82129, 79857, 83778, 83429, 83609, 81486, 81759, 84646, 79141, 80039, 79727, 80117, 84719, 83700, 83995, 81991, 85167, 85294, 83236, 84851, 87325, 84063, 86590, 84400, 83540, 79679, 78327, 79042, 79427, 79788, 78866, 79791, 79872, 79341, 79582, 80398, 84577, 84018, 83740, 86928, 85130, 86887, 87216, 84324, 87303, 87046, 90491, 91577, 88227, 90616, 89655, 87039, 89155, 91163, 90892, 86999, 88492, 85687, 87405, 89260, 91731, 85789, 86273, 85232, 83911, 84367, 88931, 88235, 88545, 84482, 82920, 83643, 84219, 84068, 89317, 88824, 86046, 83947, 83769, 89125, 85461, 83961, 91200, 88627, 85567, 88969, 89450, 88475, 88425, 84934, 84868, 85137, 86808, 85299, 90171, 89124, 88924, 86796, 88120, 86335, 86407, 90152, 94275, 94646, 95139, 87784, 86551, 87263, 87259, 88831, 90950, 90796, 89686, 87535, 92479, 93416, 88863, 89002, 87889, 89074, 90444, 88808, 89380, 88344, 90491, 90854, 90325, 91194, 92586, 94477, 96975, 91545, 92323, 91131, 97720, 93038, 96199, 95661, 96530, 96725, 98204, 97955, 96478, 94947, 93266, 92820, 94282, 92129, 95173, 94558, 92292, 95469, 94722, 95276, 96707, 100517, 94558, 95084, 96358, 98023, 98328, 97592, 94148, 101367, 95682, 96024, 102582, 95271, 100710, 96667, 100335, 97634, 98073, 103081, 96164, 101064, 96921, 97998, 101474, 99837, 95898, 94074, 94968, 99144, 100746, 99008, 96541, 95391, 94942, 94898, 95472, 96883, 101680, 104675, 98665, 104932, 98711, 98736, 102490, 98107, 100535, 97753, 100728, 99013, 97131, 97077, 98112, 101843, 103236, 104127, 103331, 102920, 102621, 104443, 99921, 102876, 98722, 101012, 101684, 102813, 103102, 103029, 107154, 102538, 105791, 104165, 99340, 103205, 105099, 104611, 104547, 104557, 102745, 100836, 103962, 104207, 103220, 100460, 100413, 100670, 100487, 112363, 111083, 112010, 112144, 112251, 106427, 101055, 101299, 101279, 101382, 104129, 103278, 101939, 101693, 101941, 103610, 102135, 103666, 104795, 105499, 105619, 103498, 103809]

x = numpy.array(iterations)
y = numpy.array(delay)

x = x[:,numpy.newaxis]
a, _, _, _ = numpy.linalg.lstsq(x, y)

print "It takes about " + str(a[0]) + " to perform one 1024 byte AES_encrypt operation"
