Anonymous traffic routing through Tor remains one of the most popular
low-latency methods for censorship evasion and privacy protection
~\cite{dingledine2004tor}. In this setup, clients protect their TCP/IP
metadata and content by routing their traffic through an onion
encrypted path with three randomly selected volunteer relay nodes,
referred to as a circuit. The network presently consists of
$\approx 6,400$ relays contributing over 160 Gbit/s of bandwidth
globally~\cite{portal2018tormetrics}. While Tor has proven to be a
highly effective option for privacy-seeking users, it suffers from two
orthogonal issues that are relevant to this work. The first is the
broad family of traffic correlation attacks. These threats are relevant in
scenarios where an attacker, who controls multiple nodes or network
vantage points, is probabilistically placed in key roles along a
single circuit, opening a much easier path to client
deanonymization~\cite{wright2004predecessor,murdoch2005low}. The
second problem is performance. Independently of the overlay protocol
itself, which generates an inherent overhead in network resources, Tor
suffers from  traffic congestion that leads to suboptimal
network performance~\cite{portal2018tormetrics,
  alsabah2016performance}.

One approach to mitigate these problems is to address them separately
from a networking standpoint. Indeed, a significant portion of recent
research in Tor proposes modifications to the core protocol itself,
such as reengineering the TCP+TLS part of the
stack~\cite{reardon2009improving} or designing a better kernel-aware
scheduler~\cite{jansen2014never}. A second approach, complementary to
the first one, observes that the anonymity and performance of the
network are both proportional to the number of nodes and users. From
this perspective, the problem becomes a largely economic question: how
can we incentivize more relay participation?

To this end, we propose to deploy a flexible tokenization strategy and present
moneTor: a monetary incentive scheme which allows relays to offer a
\emph{premium bandwidth} product to Tor users in exchange for tokens. Under this
framework, financially willing users send payments directly to each relay along
their circuits and indirectly through ``taxes'' to the Tor Project in exchange
for higher internet bandwidth and faster download speeds relative to unpaid
users. Notionally, we design moneTor tokens to serve as a bona fide form of
currency which satisfies standard definitions of \textit{scarcity},
\textit{fungibility}, \textit{divisibility}, \textit{durability}, and
\textit{transferability}~\cite[p.3]{crump2011phenomenon}. Our work aims to solve
the nontrivial technical of applying this strategy in light of the following
compulsory constraints:

\begin{itemize}
\item \emph{Anonymity}: The payment scheme may not, in any way, compromise Tor's
  primary mission to protect user anonymity.
\item \emph{Payment Security}: Financial transactions within a semi-trusted system
  cannot transpire without strong guarantees of cryptographic security.
\item \emph{Efficiency}: A robust payment system must handle extremely
  lightweight, low-latency, and scalable payments so as to accommodate
  the dynamic and often short-lived activities of these clients: Tor
  services millions of concurrent users, all of whom maintain largely
  short-term relationships.
\end{itemize}

Importantly, we acknowledge that the addition of monetary incentives into Tor
would involve delicate legal, economic, and sociopolitical considerations. Final
policy recommendations are out of scope for our work, but we do provide some
discussion in Section~\ref{sec:discussion} on the risk, merits, and versatility
of tokenization. Our essential contribution, therefore, is to offer a flexible
and value-agnostic technical design which expands the art of the possible for
Tor incentivization.

%\textbf{Present Landscape} While a number of prior works satisfy some subset of
%these constraints, no single proposal has thus far been sufficiently convincing
%so as to warrant further development.
%%We speculate that the lack of a
%%breakthrough in this niche area is not a matter of insufficient ingenuity but
%%rather one of timing.
%In recent years, there has been an explosion of academic
%research within the domain of cryptocurrencies. As of this writing, Satoshi
%Nakamoto's Bitcoin whitepaper has already garnered approximately 5,000 references in
%citing publications~\cite{nakamoto2008bitcoin}.
%%\footnote{The recency of this
%%  development is highlighted by the fact that about half of this work is dated
%%  after 2017.}
%  This body of work has sparked the development of a multitude of
%new techniques that will prove indispensable to our own area of research. Our
%objective then, is to leverage the full extent of these innovations into a
%practical next-generation incentivization strategy for Tor.

\label{sec:Contributions}
\textbf{Contributions} This work describes a full-stack framework for tokenized
Tor incentives. Our construction, called \emph{moneTor}, assumes the challenge
of applying theoretical advances in cryptocurrency research to the concrete
constraints and complexities of the live Tor network. Concretely, we introduce
highly-efficient payment protocols which extends recent work to facilitate the
novel concept of \emph{locally transparent nanopayment channels}. During data
exchange, our distributed payment processing procedure completely shifts
expensive CPU operations off of the critical path, incurring negligible
computational costs (a single hash operation) per payment and enabling fair
exchange between premium users and relays. State-of-the-art throughput is made
possible by a global payment infrastructure which utilizes trustless
\emph{Intermediaries} to handle the added CPU load potentially in exchange for
monetary rewards. The moneTor scheme adheres to the standard Tor security model
and conforms to our domain-specific constraints of \emph{Anonymity},
\emph{Payment Security}, and \emph{Efficiency}.

We provide a prototype of our payment layer and an extension to the existing
routing protocol, resulting in approximately 15k lines of new code in C within
the Tor code base. Our networking experiments demonstrate thousands of
transactions per second without any appreciable issue and achieves optimal
latency through engineered mechanisms like preemptive channel creation. Finally,
we discover through experimental analysis that scheduling
approaches~\cite{dovrolis1999case, tang2010improved} used in previous Tor
incentives systems will likely fail to offer the expected priority under the
current state of the network. Our response is to design and analyze an
alternative network prioritization strategy which combines scheduling
modifications with a new method based on control-flow windows.

%\begin{enumerate}
%\item Discuss economic considerations for the Tor network % to favor network
%  % diversity and
%  to support Tor as a public good;
%  %market control such that the Tor project can decide which notion of diversity
%  %to promote
%\item Introduce new highly-efficient nanopayment protocols which satisfy all
%  \emph{Anonymity}, \emph{Payment Security} and \emph{Efficiency}
%  constraints. These protocols are % formally  verified
%  analyzed and may be of some independent interest for
%  other high-frequency payment applications as well;
%%\item Detail our integration strategy to add a payment layer
%%  which extends the existing Tor architecture;
%\item Collect privacy-preserving client usage data in order to justify design parameters
%  and argue for their efficacy;
%\item Identify issues in previous prioritization mechanisms linked to the state of the Tor network and suggest a method of throttling to give priority users an
%  advantage which covers different states of congestion inside the Tor network;
%\item Implement a prototype of our nanopayment protocols to extend the
%  Tor software, resulting in approximately 15k lines of new code in C;
%  %\op{Add somewhere in the paper a paragraph explaining what is in those 15k lines (everything, but crypto replaced by delays and coin management). }
%\item Conduct large scale simulations to analyze the performance impact of the
%  embedded payment and incentivization scheme.
%\end{enumerate}

%The moneTor design leverages fully-specified algorithms for some components and
%well-studied existing research for all others. On a technical level, we believe
%that moneTor could be feasibly developed today within a deployed system.
% previous wording was kinda weird because it implied moneTor could be used
% somewhere other than the Tor network

\textbf{Roadmap} In Section~\ref{sec:background}, we draw on technical
preliminaries from two distinct fields: applied Tor research and cryptographic
payment channels.
%Our contributions begin formally with Section~\ref{sec:economic}, where we first
%describe a high-level economic model for the flow of money through the
%network.
In Section~\ref{sec:payment}, we outline economical considerations and the
technical construction of our nanopayment scheme at the payment protocol level.
Section~\ref{sec:network} expands the technical construction of moneTor to cover
modifications at the network level. In Section~\ref{sec:analysis}, we justify
our design decisions with real-world data collection from live Tor users. We
continue in Section~\ref{sec:experimentations} with a validation of the
technical design, carried out through experiments performed on a native
proof-of-concept implementation. Section~\ref{sec:related_work} presents a
comparison of related work to our scheme. Finally, we reference our source code
in Section~\ref{sec:code} and offer concluding remarks in
Section~\ref{sec:conclusion}.


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../popets_monetor"
%%% End:
