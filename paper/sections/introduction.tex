Anonymous traffic routing through Tor remains one of the most popular
low-latency methods for censorship evasion and privacy protection
~\cite{dingledine2004tor}. In this setup, clients protect their TCP/IP metadata
and content by routing their traffic through an onion encrypted path with three
randomly selected volunteer relay nodes, referred to as a circuit. The network
presently consists of $\approx 6,400$ relays contributing over 160 Gbit/s of
bandwidth globally~\cite{portal2018tormetrics}. While Tor has proven to be a
highly effective option for privacy-seeking users, it suffers from two
orthogonal issues that are relevant to this work. The first is the broad family
of collusion attacks. These threats are relevant in scenarios where an attacker,
who controls multiple nodes or network vantage points, is probabilistically
placed in key roles along a single circuit, opening a much easier path to client
deanonymization~\cite{wright2004predecessor,murdoch2005low}. The second problem
is performance. Although the overlay protocol itself generates an inherent
overhead in network resources, Tor suffers from additional traffic congestion
that leads to suboptimal network performance~\cite{portal2018tormetrics,
  alsabah2016performance}.

One approach to mitigate these problems is to address them separately from a
networking standpoint. Indeed, a significant portion of recent research in Tor
proposes modifications to the core protocol itself, such as reengineering the
TCP+TLS part of the stack~\cite{reardon2009improving} or designing a better
kernel-aware scheduler~\cite{jansen2014never}. A second approach observes that
the anonymity and performance of the network are both proportional to the number
of nodes and users. From this perspective, the problem becomes a largely
economic question: how can we incentivize more relay participation?

We chose monetary incentives as a participation incentivization, and we design moneTor: a monetary incentive scheme which allows for relays to offer a \emph{premium bandwidth} product
to Tor users in exchange for monetary payments. Under this framework,
financially willing users send payments directly to each relay along their circuits and indirectly through taxes
in exchange for higher internet bandwidth and faster download speeds relative to
unpaid users. % The moneTor tokens themselves can be viewed as wrappers for some
% external financial asset that is converted at an exchange service.
The moneTor tokens %assets
are a form of programmatic money which satisfies the standard properties of
\textit{scarcity}, \textit{fungibility}, \textit{divisibility},
\textit{durability}, and
\textit{transferability}~\cite[p.3]{crump2011phenomenon}.

Aside from the analytically out-of-scope set of legal and
sociopolitical obstacles which we discuss but not thoroughly investigate, monetary payments in this environment must overcome a
trifecta of challenging constraints:

\begin{itemize}
\item \emph{Anonymity}: The paramount mission of Tor is user privacy. This
  cannot be compromised or reduced by transparent money transaction trails.
\item \emph{Payment Security}: Financial transactions within an anonymity system cannot transpire
  without strong guarantees of cryptographic security.
\item \emph{Efficiency}: Tor services millions of concurrent users, all of whom
  maintain largely short-term relationships. A robust payment system must handle
  extremely lightweight and scalable payments so as to accommodate the dynamic
  and often short-lived activities of these clients, which may include web
  browsing and large file transfers.
\end{itemize}

%\textbf{Present Landscape} While a number of prior works satisfy some subset of
%these constraints, no single proposal has thus far been sufficiently convincing
%so as to warrant further development.
%%We speculate that the lack of a
%%breakthrough in this niche area is not a matter of insufficient ingenuity but
%%rather one of timing.
%In recent years, there has been an explosion of academic
%research within the domain of cryptocurrencies. As of this writing, Satoshi
%Nakamoto's Bitcoin whitepaper has already garnered approximately 5,000 references in
%citing publications~\cite{nakamoto2008bitcoin}.
%%\footnote{The recency of this
%%  development is highlighted by the fact that about half of this work is dated
%%  after 2017.}
%  This body of work has sparked the development of a multitude of
%new techniques that will prove indispensable to our own area of research. Our
%objective then, is to leverage the full extent of these innovations into a
%practical next-generation incentivization strategy for Tor.

\label{sec:Contributions}
\textbf{Contributions} The moneTor scheme is a novel full-stack framework for
Tor incentives. We Introduce new highly-efficient nanopayment protocols which satisfy all \emph{Anonymity}, \emph{Payment Security} and \emph{Efficiency} constraints.
 Our construction called moneTor bridges the theoretical advance in the cryptocurrency space with the concrete requirements of a complex and advanced distributed system such as the Tor network. Concretly, we offer:
 
 \begin{itemize}
 	\item Payment protocols that shift away the heavy cryptography from the critical path when performing payments. That is, during data exchange, the payment processing logic only require computionnaly benign operations (1 hash operation per payment), and shift away the heavy operation outside of the data exchange. Our design allows to reach an unpreceding  granularity of secure and anonymous payments, enabling \textit{fair exchange} between premium users and relays without damaging the expected download time of content (that is, the payment layer overhead does not impact the data exchange).
 	\item Payment protocols that scale on trustless entities (called Intermediaries). Only a few intermediaries are required to handle the heavy cryptography of the payment layer. Their presence are incentivized by monetary rewards through payment fees, and they are only tasked to run the payment protocols (that is, those relays are not selected by clients to process user streams).
 	
 	\item An implementation prototype of our payment layer, extending the Tor Routing protocol, resulting in approximately 15k lines of new code in C. Our networking experiments handle thousands of transactions per second, and could scale to hundred thousands of transactions per second for the real Tor network.
 	
 	\item Experimental analysises showing how previous scheduling approaches~\cite{dovrolis1999case, tang2010improved} used in previous Tor incentives systems fail to offer the expected priority under the current state of the Tor network. We propose an alternative route combining previous approaches with a new method based on control-flow windows to prioritize premium flows.
 \end{itemize}
 

%\begin{enumerate}
%\item Discuss economic considerations for the Tor network % to favor network
%  % diversity and
%  to support Tor as a public good;
%  %market control such that the Tor project can decide which notion of diversity
%  %to promote
%\item Introduce new highly-efficient nanopayment protocols which satisfy all
%  \emph{Anonymity}, \emph{Payment Security} and \emph{Efficiency}
%  constraints. These protocols are % formally  verified
%  analyzed and may be of some independent interest for
%  other high-frequency payment applications as well;
%%\item Detail our integration strategy to add a payment layer
%%  which extends the existing Tor architecture;
%\item Collect privacy-preserving client usage data in order to justify design parameters
%  and argue for their efficacy;
%\item Identify issues in previous prioritization mechanisms linked to the state of the Tor network and suggest a method of throttling to give priority users an
%  advantage which covers different states of congestion inside the Tor network;
%\item Implement a prototype of our nanopayment protocols to extend the
%  Tor software, resulting in approximately 15k lines of new code in C;
%  %\op{Add somewhere in the paper a paragraph explaining what is in those 15k lines (everything, but crypto replaced by delays and coin management). }
%\item Conduct large scale simulations to analyze the performance impact of the
%  embedded payment and incentivization scheme.
%\end{enumerate}

%The moneTor design leverages fully-specified algorithms for some components and
%well-studied existing research for all others. On a technical level, we believe
%that moneTor could be feasibly developed today within a deployed system.
% previous wording was kinda weird because it implied moneTor could be used
% somewhere other than the Tor network

\paragraph*{Roadmap.} In Section~\ref{sec:background}, we draw on technical
preliminaries from two distinct fields: applied Tor research and cryptographic
payment channels.
%Our contributions begin formally with Section~\ref{sec:economic}, where we first
%describe a high-level economic model for the flow of money through the
%network.
In Section~\ref{sec:payment}, we outline economical considerations, and the technical construction of
our nanopayment scheme at the payment protocol level. Section~\ref{sec:network}
expands the technical construction of moneTor to cover modifications at the
network level. In section~\ref{sec:analysis} we justify our design decisions
with real-world data collection from live Tor users. We continue in
Section~\ref{sec:experimentations} with a validation of our technical design,
carried out through experiments performed on a native proof-of-concept
implementation.
 Section~\ref{sec:related_work} presents the related work and compare them to our approach.
Finally, we reference our source code in
Section~\ref{sec:code}, and present concluding remarks in
Section~\ref{sec:conclusion}.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
